version: "3.5"

volumes: 
  centos-sag-osgi-install-home: {}
  centos-sag-osgi-sum-home:
    driver_opts:
      type: tmpfs
      device: tmpfs
  temp:
    driver_opts:
      type: tmpfs
      device: tmpfs
services:
  centos-sag-osgi-helper-base:
    build: ./build
    image: centos-sag-osgi-helper
    container_name: centos-sag-osgi-helper-base
    hostname: centos-sag-osgi-helper-base
    volumes:
      - temp:/tmp/
      - centos-sag-osgi-install-home:/opt/sag/products/
      - centos-sag-osgi-sum-home:/opt/sag/sum/
      - ${SAG_W_RUNS_FOLDER}/:/opt/sag/mnt/runs/
      - ${SAG_W_WM_LAB_HOME}/common/mount/extra:/opt/sag/mnt/extra/
      - ${SAG_W_WM_LAB_HOME}/windows/common/config/secret/:/opt/sag/mnt/secret
      - ${SAG_W_WM_LAB_HOME}/linux/scripts/:/opt/sag/mnt/scripts
      - ${SAG_W_PRODUCT_IMAGE}:/opt/sag/mnt/wm-install-files/products.zip
      - ${SAG_W_FIXES_IMAGE}:/opt/sag/mnt/wm-install-files/fixes.zip
      - ${SAG_W_INSTALLER_BIN}:/opt/sag/mnt/wm-install-files/installer.bin
      - ${SAG_W_UPD_MGR_BIN}:/opt/sag/mnt/wm-install-files/sum-bootstrap.bin
      - ${SAG_W_LIC_BR}:/opt/sag/mnt/wm-install-files/licenses/br.xml
      - ${SAG_W_LIC_MSR}:/opt/sag/mnt/wm-install-files/licenses/msr.xml
      - ${SAG_W_LIC_IS}:/opt/sag/mnt/wm-install-files/licenses/is.xml
      - ${SAG_W_LIC_UM}:/opt/sag/mnt/wm-install-files/licenses/um.xml
      - ${SAG_W_LIC_IP_IS}:/opt/sag/mnt/wm-install-files/licenses/ip/is.xml
      - ${SAG_W_LIC_IP_UM}:/opt/sag/mnt/wm-install-files/licenses/ip/um.xml
      - ${SAG_W_LIC_IP_TC_CLUSTERING_IS}:/opt/sag/mnt/wm-install-files/licenses/ip/tc-is-clustering/terracotta-license.key
      - ${SAG_W_LIC_IP_EG}:/opt/sag/mnt/wm-install-files/licenses/ip/eg.xml
      - ${SAG_W_LIC_MFT_AT}:/opt/sag/mnt/wm-install-files/licenses/mft/at.xml
      - ${SAG_W_LIC_MFT_ATG}:/opt/sag/mnt/wm-install-files/licenses/mft/atg.xml
      - ${SAG_W_LIC_API_CS}:/opt/sag/mnt/wm-install-files/licenses/apim/cs.xml
      - ${SAG_W_LIC_API_MED}:/opt/sag/mnt/wm-install-files/licenses/apim/med.xml
      - ${SAG_W_LIC_API_GW_S}:/opt/sag/mnt/wm-install-files/licenses/apim/gws.xml
      - ${SAG_W_LIC_API_GW_A}:/opt/sag/mnt/wm-install-files/licenses/apim/gwa.xml
      - ${SAG_W_LIC_API_POR}:/opt/sag/mnt/wm-install-files/licenses/apim/por.xml
    environment:
      - SAG_FIXES_ONLINE=${SAG_W_FIXES_ONLINE}
      - SAG_TAKE_SNAPHOTS=${SAG_W_TAKE_SNAPHOTS}
      - SAG_PRODUCTS_VERSION=${SAG_W_PRODUCTS_VERSION}
    entrypoint: ${SAG_W_ENTRY_POINT}